<!DOCTYPE html><html><head><meta charset="utf-8"/>
<title>tomato 1.2.4 Reference Manual</title>
<link rel='stylesheet' type='text/css' href='assets/ruff-min.css' />
<script type='text/javascript' src='assets/ruff-min.js'></script>
</head>
<body>
<div class='ruff-layout'>
<header class='ruff-layout-header ruff-hd'>
<a style='text-decoration:none;' href='tomato.html'>tomato 1.2.4 Reference Manual</a>


            <div id="ruffButtonBar">
            <button id="ruffNavMove" onclick="ruffMoveNavPane()"></button>
            <button id="ruffToggleTheme" onclick="ruffNextTheme()"></button>
            </div>
        </header><main class='ruff-layout-main ruff-bd'><h1 class='ruff'><a name='::tomato::mathquat'></a>::tomato::mathquat<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h1>
<div style='clear:both;'></div>
<p class='ruff'>A Class representing a Quaternion</p>
<h2 class='ruff'><a name='::tomato::mathquat-Classes'></a>Classes<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<h3 class='ruffclass'><a name='::tomato::mathquat::Quaternion'>Quaternion</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat" title="::tomato::mathquat" class='ruff_cmd'>::tomato::mathquat</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<h5 class='ruff'>Method summary</h5><table class='ruff_deflist'>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::constructor" title="constructor" class='ruff_cmd'>constructor</a></td><td>Constructor for the class.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::!=" title="!=" class='ruff_cmd'>!=</a></td><td>Inequality operator for two quaternions if <code>$obj</code> is quaternion component.<br> Inequality operator for quaternion and double if <code>$obj</code> is double.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::*" title="*" class='ruff_cmd'>*</a></td><td>Multiply a floating point number with a quaternion, if <code>$obj</code> is double.<br> Or multiply a quaternion with a quaternion, if <code>$obj</code> is an Quaternion object.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::+" title="+" class='ruff_cmd'>+</a></td><td>Add a floating point number to a quaternion, if <code>$obj</code> is double or add a quaternion to a quaternion, if <code>$obj</code> is an Quaternion object.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::-" title="-" class='ruff_cmd'>-</a></td><td>Subtract a floating point number from a quaternion, if <code>$obj</code> is double.<br> Or subtract a quaternion from a quaternion, if <code>$obj</code> is an Quaternion object.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::/" title="/" class='ruff_cmd'>/</a></td><td>Divide a quaternion by a floating point number, if <code>$obj</code> is double.<br> Or divide a quaternion by a quaternion, if <code>$obj</code> is an Quaternion object.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::==" title="==" class='ruff_cmd'>==</a></td><td>Equality operator for two quaternions if <code>$obj</code> is quaternion component.<br> Equality operator for quaternion and double if <code>$obj</code> is double.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::^" title="^" class='ruff_cmd'>^</a></td><td>Raise a quaternion to a floating point number.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Angle" title="Angle" class='ruff_cmd'>Angle</a></td><td>Gets the angle (in radians) describing the magnitude of the quaternion rotation about it's rotation axis.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Arg" title="Arg" class='ruff_cmd'>Arg</a></td><td>Gets the argument <code>phi = arg(q)</code> of the quaternion <code>q</code>, such that <code>q = r*(cos(phi) + u*sin(phi)) = r*exp(phi*u)</code><br> where <code>r</code> is the absolute and <code>u</code> the unit vector of <code>q</code>.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Conjugate" title="Conjugate" class='ruff_cmd'>Conjugate</a></td><td>Conjugate this quaternion.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Distance" title="Distance" class='ruff_cmd'>Distance</a></td><td>Gets the distance |a-b| of two quaternions, forming a metric space.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Exp" title="Exp" class='ruff_cmd'>Exp</a></td><td>Exponential Function.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Get" title="Get" class='ruff_cmd'>Get</a></td><td>Gets values from the Quaternion Class under Tcl list form.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::GetType" title="GetType" class='ruff_cmd'>GetType</a></td><td>Gets the name of class.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::ImagX" title="ImagX" class='ruff_cmd'>ImagX</a></td><td>Gets the imaginary X part (coefficient of complex I) of the quaternion.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::ImagY" title="ImagY" class='ruff_cmd'>ImagY</a></td><td>Gets the imaginary Y part (coefficient of complex J) of the quaternion.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::ImagZ" title="ImagZ" class='ruff_cmd'>ImagZ</a></td><td>Gets the imaginary Z part (coefficient of complex K) of the quaternion.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Inversed" title="Inversed" class='ruff_cmd'>Inversed</a></td><td>Gets an inverted quaternion. Inversing Zero returns Zero</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::IsInfinity" title="IsInfinity" class='ruff_cmd'>IsInfinity</a></td><td>Gets a value indicating whether the quaternion is not a number</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::IsNan" title="IsNan" class='ruff_cmd'>IsNan</a></td><td>Gets a value indicating whether the quaternion is not a number</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::IsUnitQuaternion" title="IsUnitQuaternion" class='ruff_cmd'>IsUnitQuaternion</a></td><td>Gets a value indicating whether the quaternion q has length |q| = 1. To normalize a quaternion to a length of 1, use the <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Normalized" title="Normalized" class='ruff_cmd'>Normalized</a> method. All unit quaternions form a 3-sphere.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Log" title="Log" class='ruff_cmd'>Log</a></td><td>Logarithm to a given base.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Log10" title="Log10" class='ruff_cmd'>Log10</a></td><td>Common Logarithm to base 10.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Negate" title="Negate" class='ruff_cmd'>Negate</a></td><td>Negate a quaternion.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Norm" title="Norm" class='ruff_cmd'>Norm</a></td><td>Gets the norm of the quaternion q: square root of the sum of the squares of the four components.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Normalized" title="Normalized" class='ruff_cmd'>Normalized</a></td><td>Gets a new normalized Quaternion <code>q</code> with the direction of this quaternion.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::NormalizedVector" title="NormalizedVector" class='ruff_cmd'>NormalizedVector</a></td><td>Gets a new normalized Quaternion <code>u</code> with the Vector part only, such that <code>||u|| = 1</code>.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::NormSquared" title="NormSquared" class='ruff_cmd'>NormSquared</a></td><td>Gets the sum of the squares of the four components.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Real" title="Real" class='ruff_cmd'>Real</a></td><td>Gets the real part of the quaternion.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Rotate" title="Rotate" class='ruff_cmd'>Rotate</a></td><td>Rotate a 3D vector or 3D point by the rotation stored in the Quaternion object</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::RotateRotationQuaternion" title="RotateRotationQuaternion" class='ruff_cmd'>RotateRotationQuaternion</a></td><td>Rotates the provided rotation quaternion with this quaternion.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::RotateUnitQuaternion" title="RotateUnitQuaternion" class='ruff_cmd'>RotateUnitQuaternion</a></td><td>Rotates the provided unit quaternion with this quaternion.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Scalar" title="Scalar" class='ruff_cmd'>Scalar</a></td><td>Gets a new Quaternion <code>q</code> with the Scalar part only.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Sqrt" title="Sqrt" class='ruff_cmd'>Sqrt</a></td><td>Square root of the Quaternion: q^(1/2).</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::ToString" title="ToString" class='ruff_cmd'>ToString</a></td><td>Returns a string representation of this object.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::ToVector3D" title="ToVector3D" class='ruff_cmd'>ToVector3D</a></td><td>Gets the Vector part only.</td></tr>
<tr><td><a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Vector" title="Vector" class='ruff_cmd'>Vector</a></td><td>Gets a new Quaternion <code>q</code> with the Vector part only.</td></tr>
</table>
<h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::constructor'>constructor</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Initializes a new Quaternion Class.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Quaternion create OBJNAME</span> <span class='ruff_arg'>?args?</span><br><span class='ruff_cmd'>Quaternion new</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>args</code></td><td>Options described below.</td></tr>
<tr><td><code>component1</code></td><td>-scalar &amp; -vector</td></tr>
<tr><td><code>component2</code></td><td>-axis &amp; -angle</td></tr>
<tr><td><code>list</code></td><td>A list of 4 elements</td></tr>
<tr><td><code>no values</code></td><td>default to <code>Quaternion(1 +0i +0j +0k)</code>.</td></tr>
<tr><td><code>scalar</code></td><td>A scalar value</td></tr>
<tr><td><code>values</code></td><td>3 values or 4 values</td></tr>
<tr><td><code>vector</code></td><td>A Vector3d Class <a href="tomato-tomato-mathvec3d.html#::tomato::mathvec3d::Vector3d" title="mathvec3d::Vector3d" class='ruff_cmd'>mathvec3d::Vector3d</a></td></tr>
</table>
<h5 class='ruff'>Description</h5><ul class='ruff'>
<li>Create a quaternion by specifying a list of 4 real-numbered scalar elements.<br></li>
</ul>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>
tomato::mathquat::Quaternion new {1 2 3 4}
&gt; (1 + 2i + 3j + 4k)
</pre>

</figure><ul class='ruff'>
<li>Create a quaternion by specifying a Vector3d Class.<br></li>
</ul>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>
tomato::mathquat::Quaternion new $vectorobj
&gt; (0 + xi + yj + zk)
</pre>

</figure><ul class='ruff'>
<li>Create the quaternion representation of a scalar (single real number) value.<br></li>
</ul>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>
tomato::mathquat::Quaternion new &quot;2&quot;
The imaginary part of the resulting quaternion will always be 0i + 0j + 0k.
&gt; (2 + 0i + 0j + 0k)
</pre>

</figure><ul class='ruff'>
<li>Create a quaternion by specifying 3 real-numbered scalar elements.<br></li>
</ul>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>
tomato::mathquat::Quaternion new 1 2 3
&gt; (0 + 1i + 2j + 3k)
</pre>

</figure><ul class='ruff'>
<li>Create a quaternion by specifying 4 real-numbered scalar elements.<br></li>
</ul>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>
tomato::mathquat::Quaternion new 1 1 1 1
&gt; (1 + 1i + 1j + 1k)
</pre>

</figure><ul class='ruff'>
<li>Create a quaternion by specifying a scalar and a vector.<br> The scalar (real) and vector (imaginary) parts of the desired quaternion.<br></li>
</ul>
<table class='ruff_deflist'>
<tr><td>-vector</td><td>Can be a Vector3d class <a href="tomato-tomato-mathvec3d.html#::tomato::mathvec3d::Vector3d" title="mathvec3d::Vector3d" class='ruff_cmd'>mathvec3d::Vector3d</a> or list of 3 values</td></tr>
</table>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>
tomato::mathquat::Quaternion new -scalar 1 -vector {1 1 1}
&gt; (1 + 1i + 1j + 1k)
</pre>

</figure><ul class='ruff'>
<li>Create a quaternion by specifying a axis and a angle in degrees.<br> Specify the angle (degrees) for a rotation about an axis vector [x, y, z] to be described by the quaternion object<br></li>
</ul>
<table class='ruff_deflist'>
<tr><td>-axis</td><td>Can be a Vector3d class <a href="tomato-tomato-mathvec3d.html#::tomato::mathvec3d::Vector3d" title="mathvec3d::Vector3d" class='ruff_cmd'>mathvec3d::Vector3d</a> or list of 3 values</td></tr>
</table>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>
tomato::mathquat::Quaternion new -axis {0 1 0} -angle 90
&gt; (0.707 +0i +0.707j +0k)
</pre>

</figure><ul class='ruff'>
<li>Default value :</li>
</ul>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>
tomato::mathquat::Quaternion new
&gt; (1 +0i +0j +0k)
</pre>

</figure><p class='ruff'>An error exception is raised if <code>args</code> is not the one desired.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_70' href="javascript:toggleSource('70')">Show source</a></p>
<div id='70' class='ruff_dyn_src'><pre>method constructor {args} {

    # Initializes a new Quaternion Class.
    #
    # args - Options described below.
    #
    # list       - A list of 4 elements
    # vector     - A Vector3d Class [mathvec3d::Vector3d]
    # scalar     - A scalar value
    # values     - 3 values or 4 values
    # component1 - -scalar &amp; -vector
    # component2 - -axis &amp; -angle
    # no values  - default to `Quaternion(1 +0i +0j +0k)`.
    #

    if {[llength $args] == 1} {

        if {[llength {*}$args] == 4} {
            #ruff
            # * Create a quaternion by specifying a list of 4 real-numbered scalar elements.&lt;br&gt;
            # ```
            # tomato::mathquat::Quaternion new {1 2 3 4}
            # &gt; (1 + 2i + 3j + 4k)
            # ```
            lassign {*}$args w x y z
            set _w $w
            set _x $x
            set _y $y
            set _z $z

        } elseif {[tomato::helper::TypeOf $args Isa &quot;Vector3d&quot;]} {
            #ruff
            # * Create a quaternion by specifying a Vector3d Class.&lt;br&gt;
            # ```
            # tomato::mathquat::Quaternion new $vectorobj
            # &gt; (0 + xi + yj + zk)
            # ```
            lassign [$args Get] x y z
            set _w 0
            set _x $x
            set _y $y
            set _z $z

        } elseif {[tomato::mathquat::_checkvalue $args]} {
            #ruff
            # * Create the quaternion representation of a scalar (single real number) value.&lt;br&gt;
            # ```
            # tomato::mathquat::Quaternion new &quot;2&quot;
            # The imaginary part of the resulting quaternion will always be 0i + 0j + 0k.
            # &gt; (2 + 0i + 0j + 0k)
            # ```
            set _w $args
            set _x 0
            set _y 0
            set _z 0

        } else {
            error &quot;arg must be a Vector3d, one scalar value, or 4 values ...&quot;
        }

    } elseif {[llength $args] == 3} {
        #ruff
        # * Create a quaternion by specifying 3 real-numbered scalar elements.&lt;br&gt;
        # ```
        # tomato::mathquat::Quaternion new 1 2 3
        # &gt; (0 + 1i + 2j + 3k)
        # ```
        lassign $args x y z
        set _w 0
        set _x $x
        set _y $y
        set _z $z

    } elseif {[llength $args] == 4} {

        if {[tomato::mathquat::_checkvalue $args]} {
            #ruff
            # * Create a quaternion by specifying 4 real-numbered scalar elements.&lt;br&gt;
            # ```
            # tomato::mathquat::Quaternion new 1 1 1 1
            # &gt; (1 + 1i + 1j + 1k)
            # ```
            lassign $args w x y z
            set _w $w
            set _x $x
            set _y $y
            set _z $z

        } else {

            if {[string match &quot;*-scalar*&quot; $args] &amp;&amp; ![string match &quot;*-vector*&quot; $args]} {
                #ruff
                # * Create a quaternion by specifying a scalar and a vector.&lt;br&gt;
                # The scalar (real) and vector (imaginary) parts of the desired quaternion.&lt;br&gt;
                # -vector - Can be a Vector3d class [mathvec3d::Vector3d] or list of 3 values
                # ```
                # tomato::mathquat::Quaternion new -scalar 1 -vector {1 1 1}
                # &gt; (1 + 1i + 1j + 1k)
                # ```
                error &quot;Key 'scalar' must be associated with 'vector'&quot;
            }

            if {[string match &quot;*-axis*&quot; $args] &amp;&amp; ![string match &quot;*-angle*&quot; $args]} {
                #ruff
                # * Create a quaternion by specifying a axis and a angle in degrees.&lt;br&gt;
                # Specify the angle (degrees) for a rotation about an axis vector \[x, y, z] to be described by the quaternion object&lt;br&gt;
                # -axis - Can be a Vector3d class [mathvec3d::Vector3d] or list of 3 values
                # ```
                # tomato::mathquat::Quaternion new -axis {0 1 0} -angle 90
                # &gt; (0.707 +0i +0.707j +0k)
                # ```
                error &quot;Key 'axis' must be associated with 'angle'&quot;
            }

            set options [dict create]

            foreach {key value} $args {

                if {$value eq &quot;&quot;} {
                    error &quot;No value specified for key '$key'&quot;
                }

                switch -exact -- $key {
                    &quot;-scalar&quot; {dict set options Scalar $value}
                    &quot;-axis&quot; -
                    &quot;-vector&quot; {
                                if {[tomato::helper::TypeOf $value Isa &quot;Vector3d&quot;]} {
                                    dict set options Vector $value
                                } elseif {[string is list $value] &amp;&amp; [llength $value] == 3} {
                                    dict set options Vector [tomato::mathvec3d::Vector3d new $value]
                                } else {
                                    error &quot;Value for Key '$key' must be an Class Vector3d or a list of 3 elements...&quot;
                                }
                              }
                    &quot;-angle&quot; {dict set options Angle $value}
                    default  {error &quot;Unknown key '$key' specified&quot;}

                }

            }

            if {[dict exists $options Vector] &amp;&amp; [dict exists $options Angle]} {
                lassign [tomato::mathquat::_init_from_vector_angle [dict get $options Vector]  [dict get $options Angle]] w x y z

                set _w $w ; set _x $x ; set _y $y ; set _z $z

            } elseif {[dict exists $options Scalar] &amp;&amp; [dict exists $options Vector]} {

                lassign [[dict get $options Vector] Get] x y z

                set _w [dict get $options Scalar] ; set _x $x ; set _y $y ; set _z $z
            }


        }

    } elseif {[llength $args] == 0} {
        #ruff
        # * Default value :
        # ```
        # tomato::mathquat::Quaternion new
        # &gt; (1 +0i +0j +0k)
        # ```
        set _w 1
        set _x 0
        set _y 0
        set _z 0
    } else {
        #ruff
        # An error exception is raised if `args` is not the one desired.
        error &quot;The argument does not match the requested values, please refer to the documentation...&quot;
    }
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::!='>!=</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Inequality operator for two quaternions if <code>$obj</code> is quaternion component.<br> Inequality operator for quaternion and double if <code>$obj</code> is double.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT !=</span> <span class='ruff_arg'>obj ?tolerance?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>obj</code></td><td>Options described below.</td></tr>
<tr><td><code>tolerance</code></td><td>A tolerance (epsilon) to adjust for floating point error. Optional, default <code>$::tomato::helper::TolEquals</code>.</td></tr>
<tr><td><code>object</code></td><td>A Quaternion component.</td></tr>
<tr><td><code>scalar</code></td><td>A double value.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns <code>True</code> if the quaternions are not the same if <code>$obj</code> is a quaternion or True if the real part of the quaternion is not equal to the double and the rest of the quaternion is almost 0. Otherwise <code>False</code>.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_71' href="javascript:toggleSource('71')">Show source</a></p>
<div id='71' class='ruff_dyn_src'><pre>method != {obj {tolerance {$::tomato::helper::TolEquals}}} {

    # Inequality operator for two quaternions if $obj is quaternion component.&lt;br&gt;
    # Inequality operator for quaternion and double if $obj is double.
    #
    # obj - Options described below.
    #
    # scalar    - A double value.
    # object    - A Quaternion component.
    # tolerance - A tolerance (epsilon) to adjust for floating point error.
    #
    # Returns `True` if the quaternions are not the same if $obj is a quaternion or
    # True if the real part of the quaternion is not equal to the double and the rest of the quaternion is almost 0. Otherwise `False`.
    if {[llength [info level 0]] &lt; 4} {
        set tolerance $::tomato::helper::TolEquals
    }

    return [expr {![my == $obj $tolerance]}]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::*'>*</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Multiply a floating point number with a quaternion, if <code>$obj</code> is double.<br> Or multiply a quaternion with a quaternion, if <code>$obj</code> is an Quaternion object.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT *</span> <span class='ruff_arg'>obj</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>obj</code></td><td>Options described below.</td></tr>
<tr><td><code>object</code></td><td>A Quaternion component.</td></tr>
<tr><td><code>scalar</code></td><td>A double value.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A new quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a>.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_72' href="javascript:toggleSource('72')">Show source</a></p>
<div id='72' class='ruff_dyn_src'><pre>method * {obj} {

    # Multiply a floating point number with a quaternion, if $obj is double.&lt;br&gt;
    # Or multiply a quaternion with a quaternion, if $obj is an Quaternion object.
    #
    # obj - Options described below.
    #
    # scalar - A double value.
    # object - A Quaternion component.
    #
    # Returns A new quaternion [Quaternion].
    if {[string is double $obj]} {
        return [tomato::mathquat::Quaternion new [expr {$_w * $obj}]  [expr {$_x * $obj}]  [expr {$_y * $obj}]  [expr {$_z * $obj}]]
    }

    if {[tomato::helper::TypeOf $obj Isa &quot;Quaternion&quot;]} {

        set ci [expr {($_x      * [$obj Real])  + ($_y * [$obj ImagZ]) - ($_z * [$obj ImagY]) + ($_w * [$obj ImagX])}]
        set cj [expr {(Inv($_x) * [$obj ImagZ]) + ($_y * [$obj Real])  + ($_z * [$obj ImagX]) + ($_w * [$obj ImagY])}]
        set ck [expr {($_x      * [$obj ImagY]) - ($_y * [$obj ImagX]) + ($_z * [$obj Real])  + ($_w * [$obj ImagZ])}]
        set cr [expr {(Inv($_x) * [$obj ImagX]) - ($_y * [$obj ImagY]) - ($_z * [$obj ImagZ]) + ($_w * [$obj Real])}]

        return [tomato::mathquat::Quaternion new $cr $ci $cj $ck]
    }
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::+'>+</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Add a floating point number to a quaternion, if <code>$obj</code> is double or add a quaternion to a quaternion, if <code>$obj</code> is an Quaternion object.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT +</span> <span class='ruff_arg'>obj</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>obj</code></td><td>Options described below.</td></tr>
<tr><td><code>object</code></td><td>A Quaternion component.</td></tr>
<tr><td><code>scalar</code></td><td>A double value.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A quaternion whose real value is increased by a scalar if <code>$obj</code> is double value.<br> Or the sum of two quaternions <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a> if <code>$obj</code> is a quaternion object.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_73' href="javascript:toggleSource('73')">Show source</a></p>
<div id='73' class='ruff_dyn_src'><pre>method + {obj} {

    # Add a floating point number to a quaternion, if $obj is double
    # or add a quaternion to a quaternion, if $obj is an Quaternion object.
    #
    # obj - Options described below.
    #
    # scalar - A double value.
    # object - A Quaternion component.
    #
    # Returns A quaternion whose real value is increased by a scalar if $obj is double value.&lt;br&gt;
    # Or the sum of two quaternions [Quaternion] if $obj is a quaternion object.
    if {[string is double $obj]} {
        return [tomato::mathquat::Quaternion new [expr {$_w + $obj}] $_x $_y $_z]
    }

    if {[tomato::helper::TypeOf $obj Isa &quot;Quaternion&quot;]} {
        return [tomato::mathquat::Quaternion new [expr {$_w + [$obj Real]}]  [expr {$_x + [$obj ImagX]}]  [expr {$_y + [$obj ImagY]}]  [expr {$_z + [$obj ImagZ]}]]
    }
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::-'>-</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Subtract a floating point number from a quaternion, if <code>$obj</code> is double.<br> Or subtract a quaternion from a quaternion, if <code>$obj</code> is an Quaternion object.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT -</span> <span class='ruff_arg'>obj</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>obj</code></td><td>Options described below.</td></tr>
<tr><td><code>object</code></td><td>A Quaternion component.</td></tr>
<tr><td><code>scalar</code></td><td>A double value.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A quaternion whose real value is discreased by a scalar if <code>$obj</code> is double value.<br> Or the quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a> difference if <code>$obj</code> is a quaternion object.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_74' href="javascript:toggleSource('74')">Show source</a></p>
<div id='74' class='ruff_dyn_src'><pre>method - {obj} {

    # Subtract a floating point number from a quaternion, if $obj is double.&lt;br&gt;
    # Or subtract a quaternion from a quaternion, if $obj is an Quaternion object.
    #
    # obj - Options described below.
    #
    # scalar - A double value.
    # object - A Quaternion component.
    #
    # Returns A quaternion whose real value is discreased by a scalar if $obj is double value.&lt;br&gt;
    # Or the quaternion [Quaternion] difference if $obj is a quaternion object.
    if {[string is double $obj]} {
        return [tomato::mathquat::Quaternion new [expr {$_w - $obj}] $_x $_y $_z]
    }

    if {[tomato::helper::TypeOf $obj Isa &quot;Quaternion&quot;]} {
        return [tomato::mathquat::Quaternion new [expr {$_w - [$obj Real]}]  [expr {$_x - [$obj ImagX]}]  [expr {$_y - [$obj ImagY]}]  [expr {$_z - [$obj ImagZ]}]]
    }
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::/'>/</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Divide a quaternion by a floating point number, if <code>$obj</code> is double.<br> Or divide a quaternion by a quaternion, if <code>$obj</code> is an Quaternion object.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT /</span> <span class='ruff_arg'>obj</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>obj</code></td><td>Options described below.</td></tr>
<tr><td><code>object</code></td><td>A Quaternion component.</td></tr>
<tr><td><code>scalar</code></td><td>A double value.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A new divided quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a>.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_75' href="javascript:toggleSource('75')">Show source</a></p>
<div id='75' class='ruff_dyn_src'><pre>method / {obj} {

    # Divide a quaternion by a floating point number, if $obj is double.&lt;br&gt;
    # Or divide a quaternion by a quaternion, if $obj is an Quaternion object.
    #
    # obj - Options described below.
    #
    # scalar - A double value.
    # object - A Quaternion component.
    #
    # Returns A new divided quaternion [Quaternion].
    if {[string is double $obj]} {
        return [tomato::mathquat::Quaternion new [expr {$_w / double($obj)}]  [expr {$_x / double($obj)}]  [expr {$_y / double($obj)}]  [expr {$_z / double($obj)}]]
    }

    if {[tomato::helper::TypeOf $obj Isa &quot;Quaternion&quot;]} {

        if {[$obj == $::tomato::mathquat::Zero]} {
            if {[[self] == $::tomato::mathquat::Zero]} {
                return [tomato::mathquat::Quaternion new &quot;NaN&quot; &quot;NaN&quot; &quot;NaN&quot; &quot;NaN&quot;]
            }

            return [tomato::mathquat::Quaternion new &quot;Inf&quot; &quot;Inf&quot; &quot;Inf&quot; &quot;Inf&quot;]

        }

        set normSquared [$obj NormSquared]
        set t0 [expr {(([$obj Real] * $_w) + ([$obj ImagX] * $_x) + ([$obj ImagY] * $_y) + ([$obj ImagZ] * $_z)) / double($normSquared)}]
        set t1 [expr {(([$obj Real] * $_x) - ([$obj ImagX] * $_w) - ([$obj ImagY] * $_z) + ([$obj ImagZ] * $_y)) / double($normSquared)}]
        set t2 [expr {(([$obj Real] * $_y) + ([$obj ImagX] * $_z) - ([$obj ImagY] * $_w) - ([$obj ImagZ] * $_x)) / double($normSquared)}]
        set t3 [expr {(([$obj Real] * $_z) - ([$obj ImagX] * $_y) + ([$obj ImagY] * $_x) - ([$obj ImagZ] * $_w)) / double($normSquared)}]

        return [tomato::mathquat::Quaternion new $t0 $t1 $t2 $t3]
    }
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::=='>==</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Equality operator for two quaternions if <code>$obj</code> is quaternion component.<br> Equality operator for quaternion and double if <code>$obj</code> is double.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT ==</span> <span class='ruff_arg'>obj ?tolerance?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>obj</code></td><td>Options described below.</td></tr>
<tr><td><code>tolerance</code></td><td>A tolerance (epsilon) to adjust for floating point error. Optional, default <code>$::tomato::helper::TolEquals</code>.</td></tr>
<tr><td><code>object</code></td><td>A Quaternion component.</td></tr>
<tr><td><code>scalar</code></td><td>A double value.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns <code>True</code> if the quaternions are the same if <code>$obj</code> is a quaternion or True if the real part of the quaternion is almost equal to the double and the rest of the quaternion is almost 0. Otherwise <code>False</code>.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_76' href="javascript:toggleSource('76')">Show source</a></p>
<div id='76' class='ruff_dyn_src'><pre>method == {obj {tolerance {$::tomato::helper::TolEquals}}} {

    # Equality operator for two quaternions if $obj is quaternion component.&lt;br&gt;
    # Equality operator for quaternion and double if $obj is double.
    #
    # obj - Options described below.
    #
    # scalar    - A double value.
    # object    - A Quaternion component.
    # tolerance - A tolerance (epsilon) to adjust for floating point error.
    #
    # Returns `True` if the quaternions are the same if $obj is a quaternion or
    # True if the real part of the quaternion is almost equal to the double and the rest of the quaternion is almost 0. Otherwise `False`.
    if {[llength [info level 0]] &lt; 4} {
        set tolerance $::tomato::helper::TolEquals
    }

    if {[string is double $obj]} {
        return [expr {
                        (($_w - $obj) &lt; $tolerance) &amp;&amp;
                        (($_x - 0) &lt; $tolerance) &amp;&amp;
                        (($_y - 0) &lt; $tolerance) &amp;&amp;
                        (($_z - 0) &lt; $tolerance)
                    }]
    }

    if {[tomato::helper::TypeOf $obj Isa &quot;Quaternion&quot;]} {
        return [tomato::mathquat::Equals [self] $obj $tolerance]
    }
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::^'>^</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Raise a quaternion to a floating point number.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT ^</span> <span class='ruff_arg'>obj</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>obj</code></td><td>A double value.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A new quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a>.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_77' href="javascript:toggleSource('77')">Show source</a></p>
<div id='77' class='ruff_dyn_src'><pre>method ^ {obj} {

    # Raise a quaternion to a floating point number.
    #
    # obj - A double value.
    #
    # Returns A new quaternion [Quaternion].
    return [tomato::mathquat::Pow [self] $obj]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Angle'>Angle</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the angle (in radians) describing the magnitude of the quaternion rotation about it's rotation axis.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Angle</span> </div>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A real number in the range <code>[-pi:pi]</code> describing the angle of rotation in radians about a Quaternion object's axis of rotation</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_78' href="javascript:toggleSource('78')">Show source</a></p>
<div id='78' class='ruff_dyn_src'><pre>method Angle {} {

    # Gets the angle (in radians) describing the magnitude of the quaternion rotation about it's rotation axis.
    #
    # Returns A real number in the range `[-pi:pi]` describing the angle of rotation
    # in radians about a Quaternion object's axis of rotation
    set q [self]

    if {![$q IsUnitQuaternion]} {
        set q [$q Normalized]
    }

    set norm [[$q ToVector3D] Length]

    return [tomato::mathquat::_wrap_angle [expr {2.0 * atan2($norm, [my Real])}]]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Arg'>Arg</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the argument <code>phi = arg(q)</code> of the quaternion <code>q</code>, such that <code>q = r*(cos(phi) + u*sin(phi)) = r*exp(phi*u)</code><br> where <code>r</code> is the absolute and <code>u</code> the unit vector of <code>q</code>.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Arg</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_79' href="javascript:toggleSource('79')">Show source</a></p>
<div id='79' class='ruff_dyn_src'><pre>method Arg {} {

    # Gets the argument `phi = arg(q)` of the quaternion `q`, such that `q = r*(cos(phi) +
    # u*sin(phi)) = r*exp(phi*u)`&lt;br&gt; where `r` is the absolute and `u` the unit vector of
    # `q`.
    return [expr {acos($_w / [my Norm])}]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Conjugate'>Conjugate</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Conjugate this quaternion.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Conjugate</span> </div>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A new conjugated quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a></p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_80' href="javascript:toggleSource('80')">Show source</a></p>
<div id='80' class='ruff_dyn_src'><pre>method Conjugate {} {

    # Conjugate this quaternion.
    #
    # Returns A new conjugated quaternion [Quaternion]
    return [tomato::mathquat::Quaternion new $_w  [expr {Inv($_x)}]  [expr {Inv($_y)}]  [expr {Inv($_z)}]]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Distance'>Distance</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the distance |a-b| of two quaternions, forming a metric space.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Distance</span> <span class='ruff_arg'>q</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>q</code></td><td>A Quaternion component.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns The distance between two quaternions.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_81' href="javascript:toggleSource('81')">Show source</a></p>
<div id='81' class='ruff_dyn_src'><pre>method Distance {q} {

    # Gets the distance |a-b| of two quaternions, forming a metric space.
    #
    # q - A Quaternion component.
    #
    # Returns The distance between two quaternions.
    return [[my - $q] Norm]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Exp'>Exp</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Exponential Function.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Exp</span> </div>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A new quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a></p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_82' href="javascript:toggleSource('82')">Show source</a></p>
<div id='82' class='ruff_dyn_src'><pre>method Exp {} {

    # Exponential Function.
    #
    # Returns A new quaternion [Quaternion]
    set mathE 2.7182818284590451 ; # https://docs.microsoft.com/en-us/dotnet/api/system.math.e?view=net-5.0

    set real       [expr {pow($mathE, $_w)}]
    set vector     [my Vector]
    set vectorNorm [$vector Norm]
    set cos [expr {cos($vectorNorm)}]
    set sgn [expr {[$vector == $::tomato::mathquat::Zero] ? $::tomato::mathquat::Zero : [$vector / $vectorNorm]}]
    set sin [expr {sin($vectorNorm)}]

    return [[[$sgn * $sin] + $cos] * $real]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Get'>Get</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets values from the Quaternion Class under Tcl list form.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Get</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_83' href="javascript:toggleSource('83')">Show source</a></p>
<div id='83' class='ruff_dyn_src'><pre>method Get {} {

    # Gets values from the Quaternion Class under Tcl list form.
    return [list $_x $_y $_z $_w]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::GetType'>GetType</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the name of class.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT GetType</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_84' href="javascript:toggleSource('84')">Show source</a></p>
<div id='84' class='ruff_dyn_src'><pre>method GetType {} {

    # Gets the name of class.
    return [tomato::helper::TypeClass [self]]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::ImagX'>ImagX</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the imaginary X part (coefficient of complex I) of the quaternion.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT ImagX</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_85' href="javascript:toggleSource('85')">Show source</a></p>
<div id='85' class='ruff_dyn_src'><pre>method ImagX {} {

    # Gets the imaginary X part (coefficient of complex I) of the quaternion.
    return $_x
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::ImagY'>ImagY</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the imaginary Y part (coefficient of complex J) of the quaternion.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT ImagY</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_86' href="javascript:toggleSource('86')">Show source</a></p>
<div id='86' class='ruff_dyn_src'><pre>method ImagY {} {

    # Gets the imaginary Y part (coefficient of complex J) of the quaternion.
    return $_y
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::ImagZ'>ImagZ</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the imaginary Z part (coefficient of complex K) of the quaternion.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT ImagZ</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_87' href="javascript:toggleSource('87')">Show source</a></p>
<div id='87' class='ruff_dyn_src'><pre>method ImagZ {} {

    # Gets the imaginary Z part (coefficient of complex K) of the quaternion.
    return $_z
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Inversed'>Inversed</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets an inverted quaternion. Inversing Zero returns Zero</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Inversed</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_88' href="javascript:toggleSource('88')">Show source</a></p>
<div id='88' class='ruff_dyn_src'><pre>method Inversed {} {

    # Gets an inverted quaternion. Inversing Zero returns Zero
    if {[[self] == $::tomato::mathquat::Zero]} {
        return [self]
    }

    set normSquared [my NormSquared]
    return [tomato::mathquat::Quaternion new [expr {$_w      / double($normSquared)}]  [expr {Inv($_x) / double($normSquared)}]  [expr {Inv($_y) / double($normSquared)}]  [expr {Inv($_z) / double($normSquared)}]]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::IsInfinity'>IsInfinity</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets a value indicating whether the quaternion is not a number</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT IsInfinity</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_89' href="javascript:toggleSource('89')">Show source</a></p>
<div id='89' class='ruff_dyn_src'><pre>method IsInfinity {} {

    # Gets a value indicating whether the quaternion is not a number
    foreach value [my Get] {
        if {$value eq &quot;Inf&quot;} {
            return 1
        }
    }
    return 0
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::IsNan'>IsNan</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets a value indicating whether the quaternion is not a number</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT IsNan</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_90' href="javascript:toggleSource('90')">Show source</a></p>
<div id='90' class='ruff_dyn_src'><pre>method IsNan {} {

    # Gets a value indicating whether the quaternion is not a number
    foreach value [my Get] {
        if {$value eq &quot;NaN&quot;} {
            return 1
        }
    }
    return 0
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::IsUnitQuaternion'>IsUnitQuaternion</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets a value indicating whether the quaternion q has length |q| = 1. To normalize a quaternion to a length of 1, use the <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Normalized" title="Normalized" class='ruff_cmd'>Normalized</a> method. All unit quaternions form a 3-sphere.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT IsUnitQuaternion</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_91' href="javascript:toggleSource('91')">Show source</a></p>
<div id='91' class='ruff_dyn_src'><pre>method IsUnitQuaternion {} {

    # Gets a value indicating whether the quaternion q has length |q| = 1.
    # To normalize a quaternion to a length of 1, use the [Normalized] method.
    # All unit quaternions form a 3-sphere.
    return [expr {abs(1.0 - [my NormSquared]) &lt; 1e-15}]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Log'>Log</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Logarithm to a given base.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Log</span> <span class='ruff_arg'>?lbase?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>lbase</code></td><td>A base Optional, default <code>&quot;&quot;</code>.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A new quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a></p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_92' href="javascript:toggleSource('92')">Show source</a></p>
<div id='92' class='ruff_dyn_src'><pre>method Log {{lbase {}}} {

    # Logarithm to a given base.
    #
    # lbase - A base
    #
    # Returns A new quaternion [Quaternion]
    if {[llength [info level 0]] &lt; 3} {

        if {[my == $::tomato::mathquat::One]} {return $::tomato::mathquat::One}

        set quat [[my NormalizedVector] * [my Arg]]
        return [tomato::mathquat::Quaternion new [expr {log([my Norm])}] [$quat ImagX] [$quat ImagY] [$quat ImagZ]]

    } else {
        return [[my Log] / [expr {log($lbase)}]]
    }
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Log10'>Log10</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Common Logarithm to base 10.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Log10</span> </div>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A new quaternion</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_93' href="javascript:toggleSource('93')">Show source</a></p>
<div id='93' class='ruff_dyn_src'><pre>method Log10 {} {

    # Common Logarithm to base 10.
    #
    # Returns A new quaternion
    return [[my Log] / [expr {log(10)}]]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Negate'>Negate</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Negate a quaternion.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Negate</span> </div>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A negated quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a>.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_94' href="javascript:toggleSource('94')">Show source</a></p>
<div id='94' class='ruff_dyn_src'><pre>method Negate {} {

    # Negate a quaternion.
    #
    # Returns A negated quaternion [Quaternion].
    return [tomato::mathquat::Quaternion new [expr {Inv($_w)}]  [expr {Inv($_x)}]  [expr {Inv($_y)}]  [expr {Inv($_z)}]]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Norm'>Norm</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the norm of the quaternion q: square root of the sum of the squares of the four components.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Norm</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_95' href="javascript:toggleSource('95')">Show source</a></p>
<div id='95' class='ruff_dyn_src'><pre>method Norm {} {

    # Gets the norm of the quaternion q: square root of the sum of the squares of the four components.
    return [expr {sqrt([my NormSquared])}]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Normalized'>Normalized</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets a new normalized Quaternion <code>q</code> with the direction of this quaternion.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Normalized</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_96' href="javascript:toggleSource('96')">Show source</a></p>
<div id='96' class='ruff_dyn_src'><pre>method Normalized {} {

    # Gets a new normalized Quaternion `q` with the direction of this quaternion.
    return [expr {[[self] == $::tomato::mathquat::Zero] ? [self] : [tomato::mathquat::ToUnitQuaternion $_w $_x $_y $_z]}]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::NormalizedVector'>NormalizedVector</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets a new normalized Quaternion <code>u</code> with the Vector part only, such that <code>||u|| = 1</code>.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT NormalizedVector</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_97' href="javascript:toggleSource('97')">Show source</a></p>
<div id='97' class='ruff_dyn_src'><pre>method NormalizedVector {} {

    # Gets a new normalized Quaternion `u` with the Vector part only, such that `||u|| = 1`.
    return [tomato::mathquat::ToUnitQuaternion 0 $_x $_y $_z]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::NormSquared'>NormSquared</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the sum of the squares of the four components.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT NormSquared</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_98' href="javascript:toggleSource('98')">Show source</a></p>
<div id='98' class='ruff_dyn_src'><pre>method NormSquared {} {

    # Gets the sum of the squares of the four components.
    return [tomato::mathquat::ToNormSquared $_w $_x $_y $_z]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Real'>Real</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the real part of the quaternion.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Real</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_99' href="javascript:toggleSource('99')">Show source</a></p>
<div id='99' class='ruff_dyn_src'><pre>method Real {} {

    # Gets the real part of the quaternion.
    return $_w
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Rotate'>Rotate</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Rotate a 3D vector or 3D point by the rotation stored in the Quaternion object</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Rotate</span> <span class='ruff_arg'>obj</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>obj</code></td><td>Options described below.</td></tr>
<tr><td><code>point</code></td><td>A point object.</td></tr>
<tr><td><code>vector</code></td><td>A vector object.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns The rotated vector or point returned as the same type it was specified at input</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_100' href="javascript:toggleSource('100')">Show source</a></p>
<div id='100' class='ruff_dyn_src'><pre>method Rotate {obj} {

    # Rotate a 3D vector or 3D point by the rotation stored in the Quaternion object
    #
    # obj - Options described below.
    #
    # point  - A point object.
    # vector - A vector object.
    #
    # Returns The rotated vector or point returned as the same type it was specified at input
    set myentity $obj

    if {[tomato::helper::TypeOf $obj Isa &quot;Vector3d&quot;]} {

        if {![$obj IsNormalized]} {
            set myentity [$obj Normalized]
        }

    } elseif {[tomato::helper::TypeOf $obj Isa &quot;Point3d&quot;]} {

        set myentity [$obj ToVector3D] ; # convert to vector

    } else {
        error &quot;Obj must be an Class Vector3d Or an Class Point3d...&quot;
    }

    set quat [tomato::mathquat::Quaternion new $myentity]
    set q    [self]

    if {![$q IsUnitQuaternion]} {
        set q [my Normalized]
    }

    set result [$q RotateUnitQuaternion $quat]

    if {[tomato::helper::TypeOf $obj Isa &quot;Vector3d&quot;]} {
        return [$result ToVector3D]
    } else {
        return [[$result ToVector3D] ToPoint3D]
    }
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::RotateRotationQuaternion'>RotateRotationQuaternion</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Rotates the provided rotation quaternion with this quaternion.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT RotateRotationQuaternion</span> <span class='ruff_arg'>rotation</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>rotation</code></td><td>The rotation quaternion to rotate.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A rotated quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a>.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_101' href="javascript:toggleSource('101')">Show source</a></p>
<div id='101' class='ruff_dyn_src'><pre>method RotateRotationQuaternion {rotation} {

    # Rotates the provided rotation quaternion with this quaternion.
    #
    # rotation - The rotation quaternion to rotate.
    #
    # Returns A rotated quaternion [Quaternion].
    if {![$rotation IsUnitQuaternion]} {
        error &quot;The quaternion provided is not a rotation&quot;
    }

    return [$rotation * [self]]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::RotateUnitQuaternion'>RotateUnitQuaternion</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Rotates the provided unit quaternion with this quaternion.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT RotateUnitQuaternion</span> <span class='ruff_arg'>unitQuaternion</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>unitQuaternion</code></td><td>The rotation quaternion to rotate.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A rotated quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a>.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_102' href="javascript:toggleSource('102')">Show source</a></p>
<div id='102' class='ruff_dyn_src'><pre>method RotateUnitQuaternion {unitQuaternion} {

    # Rotates the provided unit quaternion with this quaternion.
    #
    # unitQuaternion - The rotation quaternion to rotate.
    #
    # Returns A rotated quaternion [Quaternion].
    if {![my IsUnitQuaternion]} {
        error &quot;You cannot rotate with this quaternion as it is not a Unit Quaternion&quot;
    }

    # if {![$unitQuaternion IsUnitQuaternion]} {
    #     error &quot;The quaternion provided is not a Unit Quaternion&quot;
    # }

    return [[my * $unitQuaternion] * [my Conjugate]]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Scalar'>Scalar</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets a new Quaternion <code>q</code> with the Scalar part only.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Scalar</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_103' href="javascript:toggleSource('103')">Show source</a></p>
<div id='103' class='ruff_dyn_src'><pre>method Scalar {} {

    # Gets a new Quaternion `q` with the Scalar part only.
    return [tomato::mathquat::Quaternion new $_w 0 0 0]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Sqrt'>Sqrt</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Square root of the Quaternion: q^(1/2).</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Sqrt</span> </div>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A new quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a></p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_104' href="javascript:toggleSource('104')">Show source</a></p>
<div id='104' class='ruff_dyn_src'><pre>method Sqrt {} {

    # Square root of the Quaternion: q^(1/2).
    #
    # Returns A new quaternion [Quaternion]
    set arg [expr {[my Arg] * 0.5}]

    return [[my NormalizedVector] * [expr {sin($arg) + cos($arg) + sqrt($_w)}]]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::ToString'>ToString</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Returns a string representation of this object.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT ToString</span> </div>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns a string representation of this object.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_105' href="javascript:toggleSource('105')">Show source</a></p>
<div id='105' class='ruff_dyn_src'><pre>method ToString {} {

    # Returns a string representation of this object.

    set formatimgx [expr {($_x &lt; 0 ) ? &quot;%si&quot; : &quot;+%si&quot;}]
    set formatimgy [expr {($_y &lt; 0 ) ? &quot;%sj&quot; : &quot;+%sj&quot;}]
    set formatimgz [expr {($_z &lt; 0 ) ? &quot;%sk&quot; : &quot;+%sk&quot;}]


    return [format [list %s $formatimgx $formatimgy $formatimgz] $_w $_x $_y $_z]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::ToVector3D'>ToVector3D</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets the Vector part only.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT ToVector3D</span> </div>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A new vector3d <a href="tomato-tomato-mathvec3d.html#::tomato::mathvec3d::Vector3d" title="mathvec3d::Vector3d" class='ruff_cmd'>mathvec3d::Vector3d</a></p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_106' href="javascript:toggleSource('106')">Show source</a></p>
<div id='106' class='ruff_dyn_src'><pre>method ToVector3D {} {

    # Gets the Vector part only.
    #
    # Returns A new vector3d [mathvec3d::Vector3d]
    return [tomato::mathvec3d::Vector3d new $_x $_y $_z]
}</pre></div>
</div><h4 class='ruffmethod'><a name='::tomato::mathquat::Quaternion::Vector'>Vector</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="::tomato::mathquat::Quaternion" class='ruff_cmd'>::tomato::mathquat::Quaternion</a>]</span><span class='ruff-uplink'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a>, <a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Gets a new Quaternion <code>q</code> with the Vector part only.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OBJECT Vector</span> </div>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_107' href="javascript:toggleSource('107')">Show source</a></p>
<div id='107' class='ruff_dyn_src'><pre>method Vector {} {

    # Gets a new Quaternion `q` with the Vector part only.
    return [tomato::mathquat::Quaternion new 0 $_x $_y $_z]
}</pre></div>
</div><h2 class='ruff'><a name='::tomato::mathquat-Commands'></a>Commands<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<h3 class='ruffproc'><a name='::tomato::mathquat::Dot'>Dot</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat" title="::tomato::mathquat" class='ruff_cmd'>::tomato::mathquat</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Dot Product between 2 quaternions</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Dot</span> <span class='ruff_arg'>q0 q1</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>q0</code></td><td>First quaternion component</td></tr>
<tr><td><code>q1</code></td><td>Second quaternion component</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns the dot product.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_108' href="javascript:toggleSource('108')">Show source</a></p>
<div id='108' class='ruff_dyn_src'><pre>proc ::tomato::mathquat::Dot {q0 q1} {

    # Dot Product between 2 quaternions
    #
    # q0 - First quaternion component
    # q1 - Second quaternion component
    #
    # Returns the dot product.
    return [expr {
                    ([$q0 ImagX] * [$q1 ImagX]) +
                    ([$q0 ImagY] * [$q1 ImagY]) +
                    ([$q0 ImagZ] * [$q1 ImagZ]) +
                    ([$q0 Real]  * [$q1 Real])
                 }]
}</pre></div>
</div><h3 class='ruffproc'><a name='::tomato::mathquat::Equals'>Equals</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat" title="::tomato::mathquat" class='ruff_cmd'>::tomato::mathquat</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Indicate if this quaternion is equivalent to a given quaternion</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Equals</span> <span class='ruff_arg'>quaternion other tolerance</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>quaternion</code></td><td>First input vector  <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a></td></tr>
<tr><td><code>other</code></td><td>Second input vector <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a></td></tr>
<tr><td><code>tolerance</code></td><td>A tolerance (epsilon) to adjust for floating point error</td></tr>
</table>
<h5 class='ruff'>Description</h5><p class='ruff'>See : methods == !=</p>
<p class='ruff'>An error exception is raised if tolerance (epsilon) &lt; 0.</p>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns <code>True</code> if the quaternions are equal, otherwise false.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_109' href="javascript:toggleSource('109')">Show source</a></p>
<div id='109' class='ruff_dyn_src'><pre>proc ::tomato::mathquat::Equals {quaternion other tolerance} {

    # Indicate if this quaternion is equivalent to a given quaternion
    #
    # quaternion - First input vector  [Quaternion]
    # other      - Second input vector [Quaternion]
    # tolerance  - A tolerance (epsilon) to adjust for floating point error
    #
    # Returns `True` if the quaternions are equal, otherwise false.
    #
    # See : methods == !=

    if {([$other IsNan] &amp;&amp; [$quaternion IsNan]) || ([$other IsInfinity] &amp;&amp; [$quaternion IsInfinity])} {
        return 1
    }

    if {$tolerance &lt; 0} {
        #ruff
        # An error exception is raised if tolerance (epsilon) &lt; 0.
        error &quot;epsilon &lt; 0&quot;
    }

    return [expr {
                  abs([$quaternion Real]  - [$other Real])  &lt; $tolerance &amp;&amp;
                  abs([$quaternion ImagX] - [$other ImagX]) &lt; $tolerance &amp;&amp;
                  abs([$quaternion ImagY] - [$other ImagY]) &lt; $tolerance &amp;&amp;
                  abs([$quaternion ImagZ] - [$other ImagZ]) &lt; $tolerance
                }]
}</pre></div>
</div><h3 class='ruffproc'><a name='::tomato::mathquat::Pow'>Pow</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat" title="::tomato::mathquat" class='ruff_cmd'>::tomato::mathquat</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Raise the quaternion to a given power.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Pow</span> <span class='ruff_arg'>q power</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>q</code></td><td>A quaternion component.</td></tr>
<tr><td><code>power</code></td><td>A double, integer or quaternion value.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns The quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a> raised to a power of another quaternion</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_110' href="javascript:toggleSource('110')">Show source</a></p>
<div id='110' class='ruff_dyn_src'><pre>proc ::tomato::mathquat::Pow {q power} {

    # Raise the quaternion to a given power.
    #
    # q     - A quaternion component.
    # power - A double, integer or quaternion value.
    #
    # Returns The quaternion [Quaternion] raised to a power of another quaternion
    if {[string is double -strict $power]} {

        if {[$q == $::tomato::mathquat::Zero]} {return $::tomato::mathquat::Zero}
        if {[$q == $::tomato::mathquat::One]} {return $::tomato::mathquat::One}

        return [[[$q Log] * $power] Exp]
    }

    if {[string is integer -strict $power]} {

        if {$power == 0} {return $::tomato::mathquat::One}
        if {$power == 1} {return $q}
        if {[$q == $::tomato::mathquat::Zero] || [$q == $::tomato::mathquat::One]} {return $q}

        set quat [tomato::mathquat::Quaternion new [$q Real] [$q ImagX] [$q ImagY] [$q ImagZ]]

        return [$quat * [tomato::mathquat::Pow $quat [expr {$power - 1}]]]

    }

    if {[tomato::helper::TypeOf $power Isa &quot;Quaternion&quot;]} {

        if {[$q == $::tomato::mathquat::Zero]} {return $::tomato::mathquat::Zero}
        if {[$q == $::tomato::mathquat::One]} {return $::tomato::mathquat::One}

        return [[$power * [$q Log]] Exp]

    }
}</pre></div>
</div><h3 class='ruffproc'><a name='::tomato::mathquat::Slerp'>Slerp</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat" title="::tomato::mathquat" class='ruff_cmd'>::tomato::mathquat</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Spherical Linear Interpolation between quaternions. Implemented as described in <a href="https://en.wikipedia.org/wiki/Slerp" >wiki/Slerp</a></p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Slerp</span> <span class='ruff_arg'>q0 q1 ?arcposition?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>q0</code></td><td>First endpoint rotation as a Quaternion object.</td></tr>
<tr><td><code>q1</code></td><td>Second endpoint rotation as a Quaternion object.</td></tr>
<tr><td><code>arcposition</code></td><td>interpolation parameter between 0 and 1. This describes the linear placement position of <br> the result along the arc between endpoints; 0 being at <code>q0</code> and 1 being at <code>q1</code>. Optional, default <code>0.5</code>.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A new Quaternion object representing the interpolated rotation</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_111' href="javascript:toggleSource('111')">Show source</a></p>
<div id='111' class='ruff_dyn_src'><pre>proc ::tomato::mathquat::Slerp {q0 q1 {arcposition 0.5}} {

    # Spherical Linear Interpolation between quaternions.
    # Implemented as described in [wiki/Slerp](https://en.wikipedia.org/wiki/Slerp)
    #
    # q0          - First endpoint rotation as a Quaternion object.
    # q1          - Second endpoint rotation as a Quaternion object.
    # arcposition - interpolation parameter between 0 and 1. This describes the linear placement position of &lt;br&gt;
    #               the result along the arc between endpoints; 0 being at `q0` and 1 being at `q1`.
    #
    # Returns A new Quaternion object representing the interpolated rotation

    # Ensure quaternion inputs are unit quaternions and 0 &lt;= amount &lt;=1
    if {![$q0 IsUnitQuaternion]} {
        set q0 [$q0 Normalized]
    }

    if {![$q1 IsUnitQuaternion]} {
        set q1 [$q1 Normalized]
    }

    set clamparcpos [tomato::helper::Clamp $arcposition 0 1]

    set dot [tomato::mathquat::Dot $q0 $q1]

    # If the dot product is negative, slerp won't take the shorter path.
    # Note that v1 and -v1 are equivalent when the negation is applied to all four components.
    # Fix by reversing one quaternion
    if {$dot &lt; 0.0} {
        set q0  [$q0 Negate]
        set dot [expr {Inv($dot)}]
    }

    # sinalpha0 can not be zero
    if {$dot &gt; 0.9995} {
        set q [$q0 + [[$q1 - $q0] * $clamparcpos]]
        if {![$q IsUnitQuaternion]} {
            set q [$q Normalized]
        }
        return $q
    }

    set alpha0    [expr {acos($dot)}] ; # # Since dot is in range [0, 0.9995], acos() is safe
    set sinalpha0 [expr {sin($alpha0)}]

    set alpha [expr {$alpha0 * $clamparcpos}]
    set sinalpha [expr {sin($alpha)}]

    set s0 [expr {cos($alpha) - (($dot * $sinalpha) / double($sinalpha0))}]
    set s1 [expr {$sinalpha / double($sinalpha0)}]

    set q [[$q0 * $s0] + [$q1 * $s1]]

    if {![$q IsUnitQuaternion]} {
        set q [$q Normalized]
    }

    return $q
}</pre></div>
</div><h3 class='ruffproc'><a name='::tomato::mathquat::ToNormSquared'>ToNormSquared</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat" title="::tomato::mathquat" class='ruff_cmd'>::tomato::mathquat</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Calculates norm of quaternion from it's algebraical notation</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>ToNormSquared</span> <span class='ruff_arg'>real imagX imagY imagZ</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>real</code></td><td>The rotation component of the Quaternion.</td></tr>
<tr><td><code>imagX</code></td><td>The X-value of the vector component of the Quaternion.</td></tr>
<tr><td><code>imagY</code></td><td>The Y-value of the vector component of the Quaternion.</td></tr>
<tr><td><code>imagZ</code></td><td>The Z-value of the vector component of the Quaternion.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A norm squared quaternion</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_112' href="javascript:toggleSource('112')">Show source</a></p>
<div id='112' class='ruff_dyn_src'><pre>proc ::tomato::mathquat::ToNormSquared {real imagX imagY imagZ} {

    # Calculates norm of quaternion from it's algebraical notation
    #
    # real  - The rotation component of the Quaternion.
    # imagX - The X-value of the vector component of the Quaternion.
    # imagY - The Y-value of the vector component of the Quaternion.
    # imagZ - The Z-value of the vector component of the Quaternion.
    #
    # Returns A norm squared quaternion
    return [expr {($imagX**2) + ($imagY**2) + ($imagZ**2) + ($real**2)}]
}</pre></div>
</div><h3 class='ruffproc'><a name='::tomato::mathquat::ToUnitQuaternion'>ToUnitQuaternion</a><span class='ns_scope'> [<a href="tomato-tomato-mathquat.html#::tomato::mathquat" title="::tomato::mathquat" class='ruff_cmd'>::tomato::mathquat</a>]</span><span class='ruff-uplink'><a href='#top'>Top</a>, <a href='tomato.html'>Main</a>, <a href='tomato-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Creates unit quaternion (it's norm == 1) from it's algebraical notation</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>ToUnitQuaternion</span> <span class='ruff_arg'>real imagX imagY imagZ</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td><code>real</code></td><td>The rotation component of the Quaternion.</td></tr>
<tr><td><code>imagX</code></td><td>The X-value of the vector component of the Quaternion.</td></tr>
<tr><td><code>imagY</code></td><td>The Y-value of the vector component of the Quaternion.</td></tr>
<tr><td><code>imagZ</code></td><td>The Z-value of the vector component of the Quaternion.</td></tr>
</table>
<h5 class='ruff'>Return value</h5><p class='ruff'>Returns A unit quaternion <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion" title="Quaternion" class='ruff_cmd'>Quaternion</a></p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_113' href="javascript:toggleSource('113')">Show source</a></p>
<div id='113' class='ruff_dyn_src'><pre>proc ::tomato::mathquat::ToUnitQuaternion {real imagX imagY imagZ} {

    # Creates unit quaternion (it's norm == 1) from it's algebraical notation
    #
    # real  - The rotation component of the Quaternion.
    # imagX - The X-value of the vector component of the Quaternion.
    # imagY - The Y-value of the vector component of the Quaternion.
    # imagZ - The Z-value of the vector component of the Quaternion.
    #
    # Returns A unit quaternion [Quaternion]
    set norm [expr {sqrt([tomato::mathquat::ToNormSquared $real $imagX $imagY $imagZ])}]

    return [tomato::mathquat::Quaternion new [list [expr {$real  / double($norm)}]  [expr {$imagX / double($norm)}]  [expr {$imagY / double($norm)}]  [expr {$imagZ / double($norm)}]]]
}</pre></div>
</div></main><nav class='ruff-nav'><ul ><li class='ruff-toc1'><a style='padding-top:2px;' href='tomato.html'>Start page</a></li>
<li class='ruff-toc1'><a href='tomato-docindex.html' accesskey='i'>Index</a></li>
<hr>
<li class='ruff-toc1'><a href='tomato-tomato-helper.html'>tomato::helper</a></li>
<li class='ruff-toc1'><a href='tomato-tomato-mathtriangle.html'>tomato::mathtriangle</a></li>
<li class='ruff-toc1'><a href='tomato-tomato-mathcsys.html'>tomato::mathcsys</a></li>
<li class='ruff-toc1'><a class='ruff-highlight' href='tomato-tomato-mathquat.html'>tomato::mathquat</a></li>
<li class='ruff-toc1'><a href='tomato-tomato-mathline3d.html'>tomato::mathline3d</a></li>
<li class='ruff-toc1'><a href='tomato-tomato-mathray3d.html'>tomato::mathray3d</a></li>
<li class='ruff-toc1'><a href='tomato-tomato-mathpt3d.html'>tomato::mathpt3d</a></li>
<li class='ruff-toc1'><a href='tomato-tomato-mathplane.html'>tomato::mathplane</a></li>
<li class='ruff-toc1'><a href='tomato-tomato-mathmatrix3d.html'>tomato::mathmatrix3d</a></li>
<li class='ruff-toc1'><a href='tomato-tomato-mathvec3d.html'>tomato::mathvec3d</a></li>
<li class='ruff-toc1'><a href='tomato-tomato-mathmatrix.html'>tomato::mathmatrix</a></li>
<hr><li class='ruff-toc2'><a href='#::tomato::mathquat-Classes'>Classes</a></li><li class='ruff-toc3'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion'>Quaternion</a></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::constructor'>constructor</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>Quaternion create OBJNAME</span> <span class='ruff_arg'>?args?</span>
<span class='ruff_cmd'>Quaternion new</span> <span class='ruff_arg'>?args?</span></pre>Initializes a new Quaternion Class.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::!='>!=</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT !=</span> <span class='ruff_arg'>obj ?tolerance?</span></pre>Inequality operator for two quaternions if <code>$obj</code> is quaternion component.<br> Inequality operator for quaternion and double if <code>$obj</code> is double.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::*'>*</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT *</span> <span class='ruff_arg'>obj</span></pre>Multiply a floating point number with a quaternion, if <code>$obj</code> is double.<br> Or multiply a quaternion with a quaternion, if <code>$obj</code> is an Quaternion object.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::+'>+</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT +</span> <span class='ruff_arg'>obj</span></pre>Add a floating point number to a quaternion, if <code>$obj</code> is double or add a quaternion to a quaternion, if <code>$obj</code> is an Quaternion object.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::-'>-</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT -</span> <span class='ruff_arg'>obj</span></pre>Subtract a floating point number from a quaternion, if <code>$obj</code> is double.<br> Or subtract a quaternion from a quaternion, if <code>$obj</code> is an Quaternion object.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::/'>/</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT /</span> <span class='ruff_arg'>obj</span></pre>Divide a quaternion by a floating point number, if <code>$obj</code> is double.<br> Or divide a quaternion by a quaternion, if <code>$obj</code> is an Quaternion object.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::=='>==</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT ==</span> <span class='ruff_arg'>obj ?tolerance?</span></pre>Equality operator for two quaternions if <code>$obj</code> is quaternion component.<br> Equality operator for quaternion and double if <code>$obj</code> is double.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::^'>^</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT ^</span> <span class='ruff_arg'>obj</span></pre>Raise a quaternion to a floating point number.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Angle'>Angle</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Angle</span> </pre>Gets the angle (in radians) describing the magnitude of the quaternion rotation about it's rotation axis.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Arg'>Arg</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Arg</span> </pre>Gets the argument <code>phi = arg(q)</code> of the quaternion <code>q</code>, such that <code>q = r*(cos(phi) + u*sin(phi)) = r*exp(phi*u)</code><br> where <code>r</code> is the absolute and <code>u</code> the unit vector of <code>q</code>.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Conjugate'>Conjugate</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Conjugate</span> </pre>Conjugate this quaternion.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Distance'>Distance</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Distance</span> <span class='ruff_arg'>q</span></pre>Gets the distance |a-b| of two quaternions, forming a metric space.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Exp'>Exp</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Exp</span> </pre>Exponential Function.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Get'>Get</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Get</span> </pre>Gets values from the Quaternion Class under Tcl list form.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::GetType'>GetType</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT GetType</span> </pre>Gets the name of class.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::ImagX'>ImagX</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT ImagX</span> </pre>Gets the imaginary X part (coefficient of complex I) of the quaternion.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::ImagY'>ImagY</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT ImagY</span> </pre>Gets the imaginary Y part (coefficient of complex J) of the quaternion.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::ImagZ'>ImagZ</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT ImagZ</span> </pre>Gets the imaginary Z part (coefficient of complex K) of the quaternion.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Inversed'>Inversed</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Inversed</span> </pre>Gets an inverted quaternion. Inversing Zero returns Zero
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::IsInfinity'>IsInfinity</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT IsInfinity</span> </pre>Gets a value indicating whether the quaternion is not a number
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::IsNan'>IsNan</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT IsNan</span> </pre>Gets a value indicating whether the quaternion is not a number
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::IsUnitQuaternion'>IsUnitQuaternion</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT IsUnitQuaternion</span> </pre>Gets a value indicating whether the quaternion q has length |q| = 1. To normalize a quaternion to a length of 1, use the <a href="tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Normalized" title="Normalized" class='ruff_cmd'>Normalized</a> method. All unit quaternions form a 3-sphere.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Log'>Log</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Log</span> <span class='ruff_arg'>?lbase?</span></pre>Logarithm to a given base.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Log10'>Log10</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Log10</span> </pre>Common Logarithm to base 10.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Negate'>Negate</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Negate</span> </pre>Negate a quaternion.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Norm'>Norm</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Norm</span> </pre>Gets the norm of the quaternion q: square root of the sum of the squares of the four components.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Normalized'>Normalized</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Normalized</span> </pre>Gets a new normalized Quaternion <code>q</code> with the direction of this quaternion.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::NormalizedVector'>NormalizedVector</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT NormalizedVector</span> </pre>Gets a new normalized Quaternion <code>u</code> with the Vector part only, such that <code>||u|| = 1</code>.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::NormSquared'>NormSquared</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT NormSquared</span> </pre>Gets the sum of the squares of the four components.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Real'>Real</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Real</span> </pre>Gets the real part of the quaternion.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Rotate'>Rotate</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Rotate</span> <span class='ruff_arg'>obj</span></pre>Rotate a 3D vector or 3D point by the rotation stored in the Quaternion object
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::RotateRotationQuaternion'>RotateRotationQuaternion</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT RotateRotationQuaternion</span> <span class='ruff_arg'>rotation</span></pre>Rotates the provided rotation quaternion with this quaternion.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::RotateUnitQuaternion'>RotateUnitQuaternion</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT RotateUnitQuaternion</span> <span class='ruff_arg'>unitQuaternion</span></pre>Rotates the provided unit quaternion with this quaternion.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Scalar'>Scalar</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Scalar</span> </pre>Gets a new Quaternion <code>q</code> with the Scalar part only.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Sqrt'>Sqrt</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Sqrt</span> </pre>Square root of the Quaternion: q^(1/2).
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::ToString'>ToString</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT ToString</span> </pre>Returns a string representation of this object.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::ToVector3D'>ToVector3D</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT ToVector3D</span> </pre>Gets the Vector part only.
</span></li><li class='ruff-toc4 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Quaternion::Vector'>Vector</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>OBJECT Vector</span> </pre>Gets a new Quaternion <code>q</code> with the Vector part only.
</span></li><li class='ruff-toc2'><a href='#::tomato::mathquat-Commands'>Commands</a></li><li class='ruff-toc3 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Dot'>Dot</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>Dot</span> <span class='ruff_arg'>q0 q1</span></pre>Dot Product between 2 quaternions
</span></li><li class='ruff-toc3 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Equals'>Equals</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>Equals</span> <span class='ruff_arg'>quaternion other tolerance</span></pre>Indicate if this quaternion is equivalent to a given quaternion
</span></li><li class='ruff-toc3 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Pow'>Pow</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>Pow</span> <span class='ruff_arg'>q power</span></pre>Raise the quaternion to a given power.
</span></li><li class='ruff-toc3 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::Slerp'>Slerp</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>Slerp</span> <span class='ruff_arg'>q0 q1 ?arcposition?</span></pre>Spherical Linear Interpolation between quaternions. Implemented as described in <a href="https://en.wikipedia.org/wiki/Slerp" >wiki/Slerp</a>
</span></li><li class='ruff-toc3 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::ToNormSquared'>ToNormSquared</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>ToNormSquared</span> <span class='ruff_arg'>real imagX imagY imagZ</span></pre>Calculates norm of quaternion from it's algebraical notation
</span></li><li class='ruff-toc3 ruff-tip'><a href='tomato-tomato-mathquat.html#::tomato::mathquat::ToUnitQuaternion'>ToUnitQuaternion</a><span class='ruff-tiptext'><pre><span class='ruff_cmd'>ToUnitQuaternion</span> <span class='ruff_arg'>real imagX imagY imagZ</span></pre>Creates unit quaternion (it's norm == 1) from it's algebraical notation
</span></li></ul></nav><footer class='ruff-layout-footer ruff-ft'><div style='float: right;'>Document generated by <a href='https://ruff.magicsplat.com'>Ruff!</a></div></footer>
</div></body></html>
